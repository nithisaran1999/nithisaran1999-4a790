---
import Layout from '../layouts/Layout.astro';
---

<Layout title="Nithisaran | Full Stack Developer">
    <section class="tui-window">
        <div class="tui-titlebar">
            <p class="inline-flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <rect x="3" y="4" width="18" height="16" rx="2"></rect>
                    <path d="m7 9 3 3-3 3"></path>
                    <path d="M13 15h4"></path>
                </svg>
                portfolio.sh
            </p>
            <p class="text-blue-300">
                <span class="lang-en">status: online</span>
                <span class="lang-th">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
            </p>
        </div>

        <div class="grid gap-4 p-5 sm:p-8">
            <div class="tui-panel">
                <div class="grid items-center gap-5 sm:grid-cols-[140px_1fr]">
                    <img
                        src="/images/profile-avatar.png"
                        alt="Profile picture"
                        width="140"
                        height="140"
                        class="w-[110px] h-[110px] sm:w-[140px] sm:h-[140px] rounded-md border border-blue-600/80 bg-blue-950/50"
                    />
                    <div>
                        <p class="mb-2 font-mono text-sm text-blue-300">$ whoami</p>
                        <h1 class="mb-2 text-blue-50">Nithisaran</h1>
                        <p class="mb-2 text-blue-300">
                            <span class="lang-en">Full Stack Developer</span>
                            <span class="lang-th">‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤ Full Stack</span>
                        </p>
                        <p class="max-w-3xl text-blue-100">
                            <span class="lang-en">
                                I am Nithisaran, a Full Stack Developer based in Thailand.
                                I build reliable web applications from frontend interfaces to backend APIs and deployment pipelines.
                                My focus is clean architecture, scalable systems, and fast user experiences.
                            </span>
                            <span class="lang-th">
                                ‡∏ú‡∏°‡∏ä‡∏∑‡πà‡∏≠ Nithisaran ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤ Full Stack ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢
                                ‡∏ú‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á API ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö deploy
                                ‡πÇ‡∏î‡∏¢‡πÄ‡∏ô‡πâ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß
                            </span>
                        </p>
                    </div>
                </div>
            </div>

            <div id="about" class="tui-panel">
                <p class="mb-2 font-mono text-sm text-blue-300">$ cat about.txt</p>
                <p class="text-blue-100">
                    <span class="lang-en">
                        I work across both frontend and backend systems, delivering complete products from idea to production.
                        My frontend experience includes React and Angular, and my backend experience includes Django and Spring Boot.
                        I also have hands-on experience with Google Firebase, including authentication (login) and database integration.
                    </span>
                    <span class="lang-th">
                        ‡∏ú‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ù‡∏±‡πà‡∏á frontend ‡πÅ‡∏•‡∏∞ backend ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏à‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á
                        ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ù‡∏±‡πà‡∏á frontend ‡∏Ñ‡∏∑‡∏≠ React ‡πÅ‡∏•‡∏∞ Angular ‡∏™‡πà‡∏ß‡∏ô backend ‡∏Ñ‡∏∑‡∏≠ Django ‡πÅ‡∏•‡∏∞ Spring Boot
                        ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Google Firebase ‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </span>
                </p>
            </div>

            <div id="skills" class="tui-panel">
                <p class="mb-3 font-mono text-sm text-blue-300">$ ls skills/</p>
                <div class="grid gap-3 sm:grid-cols-2">
                    <p class="inline-flex items-center gap-2">
                        <span aria-hidden="true">üñ•Ô∏è</span>
                        <span><span class="tui-kbd">Frontend</span> React, Angular, Astro, Tailwind CSS</span>
                    </p>
                    <p class="inline-flex items-center gap-2">
                        <span aria-hidden="true">‚öôÔ∏è</span>
                        <span><span class="tui-kbd">Backend</span> Django, Spring Boot, REST APIs</span>
                    </p>
                    <p class="inline-flex items-center gap-2">
                        <span aria-hidden="true">‚òÅÔ∏è</span>
                        <span>
                        <span class="tui-kbd lang-en">Cloud DB</span>
                        <span class="tui-kbd lang-th">‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå</span>
                        Google Firebase (Auth + Database)
                        </span>
                    </p>
                    <p class="inline-flex items-center gap-2">
                        <span aria-hidden="true">üêß</span>
                        <span>
                        <span class="tui-kbd lang-en">Tools</span>
                        <span class="tui-kbd lang-th">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠</span>
                        Git, CI/CD, Docker, Linux
                        </span>
                    </p>
                </div>
            </div>

            <div id="experience" class="tui-panel">
                <p class="mb-3 font-mono text-sm text-blue-300">$ cat experience.log</p>
                <div class="grid gap-3">
                    <article class="p-4 border rounded border-blue-700/70 bg-blue-950/35">
                        <p class="text-xs text-blue-300">2021 | Internship | Chiang Mai, Thailand</p>
                        <h2 class="mt-1 mb-2 text-lg text-blue-50">Intern ‚Ä¢ 4Xtreme</h2>
                        <p class="text-sm text-blue-100">
                            <span class="lang-en">
                                Completed internship at
                                <a href="https://www.4xtreme.com/" target="_blank" rel="noreferrer" class="text-blue-300">4Xtreme</a>
                                in Chiang Mai, Thailand. I worked on frontend tasks using Entity Framework.
                            </span>
                            <span class="lang-th">
                                ‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà
                                <a href="https://www.4xtreme.com/" target="_blank" rel="noreferrer" class="text-blue-300">4Xtreme</a>
                                ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ ‡πÇ‡∏î‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏≤‡∏ô frontend ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Entity Framework
                            </span>
                        </p>
                    </article>
                    <article class="p-4 border rounded border-blue-700/70 bg-blue-950/35">
                        <p class="text-xs text-blue-300">2024 - Present | Bangkok, Thailand</p>
                        <h2 class="mt-1 mb-2 text-lg text-blue-50">Full Stack Developer ‚Ä¢ 1008Bit Company</h2>
                        <p class="text-sm text-blue-100">
                            <span class="lang-en">
                                At 1008Bit Company, I develop and maintain business web platforms using React and Angular on frontend,
                                with Django and Spring Boot services on backend. Built reusable API modules and release workflows
                                that reduced deployment time for feature updates.
                            </span>
                            <span class="lang-th">
                                ‡∏ó‡∏µ‡πà 1008Bit Company ‡∏ú‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏ß‡πá‡∏ö‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ React ‡πÅ‡∏•‡∏∞ Angular ‡∏ù‡∏±‡πà‡∏á frontend
                                ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Django ‡∏Å‡∏±‡∏ö Spring Boot ‡∏ù‡∏±‡πà‡∏á backend ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏°‡∏î‡∏π‡∏• API ‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ
                                ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
                            </span>
                        </p>
                    </article>
                </div>
            </div>

            <div id="contact" class="tui-panel">
                <p class="mb-2 font-mono text-sm text-blue-300">$ ./contact.sh</p>
                <p class="text-blue-100">
                    <span class="lang-en"><del>Open to full-time, freelance, and contract opportunities.</del> <strong>Hired.</strong></span>
                    <span class="lang-th"><del>‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥ ‡∏á‡∏≤‡∏ô‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå ‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡πâ‡∏≤‡∏á</del> <strong>‡πÑ‡∏î‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß</strong></span>
                </p>
                <div class="mt-3 flex flex-wrap gap-3">
                    <a href="mailto:nithisaran1999@gmail.com" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <rect x="3" y="5" width="18" height="14" rx="2"></rect>
                            <path d="m3 7 9 6 9-6"></path>
                        </svg>
                        <span class="lang-en">Send Email</span>
                        <span class="lang-th">‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•</span>
                    </a>
                    <button id="downloadCvEnBtn" type="button" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M12 3v12"></path>
                            <path d="m7 10 5 5 5-5"></path>
                            <path d="M5 21h14"></path>
                        </svg>
                        <span>Download CV EN</span>
                    </button>
                    <button id="downloadCvThBtn" type="button" class="btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M12 3v12"></path>
                            <path d="m7 10 5 5 5-5"></path>
                            <path d="M5 21h14"></path>
                        </svg>
                        <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î CV TH</span>
                    </button>
                </div>
            </div>
        </div>
    </section>
</Layout>

<script>
    import { jsPDF } from 'jspdf';
    import html2canvas from 'html2canvas';

    const cleanText = (value) => value.replace(/\s+/g, ' ').trim();
    const removeIcons = (value) => cleanText(value.replace(/[üñ•Ô∏è‚öôÔ∏è‚òÅÔ∏èüêß‚óâ‚åÅ‚ñ¶‚åò‚úâ]/gu, ''));
    const escapeHtml = (value) =>
        value
            .replaceAll('&', '&amp;')
            .replaceAll('<', '&lt;')
            .replaceAll('>', '&gt;')
            .replaceAll('"', '&quot;')
            .replaceAll("'", '&#39;');

    const getLocalizedText = (element, lang) => {
        const localizedElement = element.querySelector(`.lang-${lang}`);
        if (localizedElement) {
            return cleanText(localizedElement.textContent || '');
        }

        return cleanText(element.textContent || '');
    };

    const buildCvData = (lang) => {
        const name = cleanText(document.querySelector('h1')?.textContent || 'Nithisaran');
        const role = getLocalizedText(document.querySelector('h1 + p') || document.body, lang);
        const summary = getLocalizedText(document.querySelector('h1 + p + p') || document.body, lang);

        const about = getLocalizedText(document.querySelector('#about .text-blue-100') || document.body, lang);

        const skillItemsByLang = {
            en: [
                'Frontend: React, Angular, Astro, Tailwind CSS',
                'Backend: Django, Spring Boot, REST APIs',
                'Cloud DB: Google Firebase (Auth + Database)',
                'Tools: Git, CI/CD, Docker, Linux'
            ],
            th: [
                '‡∏û‡∏±‡∏í‡∏ô‡∏≤ Frontend: React, Angular, Astro, Tailwind CSS',
                '‡∏û‡∏±‡∏í‡∏ô‡∏≤ Backend: Django, Spring Boot, REST APIs',
                '‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ô‡∏Ñ‡∏•‡∏≤‡∏ß‡∏î‡πå: Google Firebase (Authentication ‡πÅ‡∏•‡∏∞ Database)',
                '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö: Git, CI/CD, Docker, Linux'
            ]
        };

        const skillItems = skillItemsByLang[lang];

        const experienceItems = [...document.querySelectorAll('#experience article')].map((article) => {
            const title = removeIcons(article.querySelector('h2')?.textContent || '');
            const period = cleanText(article.querySelector('p')?.textContent || '');
            let details = removeIcons(getLocalizedText(article.querySelector('.text-blue-100') || article, lang));
            let achievement = '';

            if (lang === 'th') {
                if (title.includes('4Xtreme')) {
                    details = '‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏á‡∏≤‡∏ô‡∏û‡∏±‡∏í‡∏ô‡∏≤ Frontend ‡∏ï‡∏≤‡∏°‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Entity Framework ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏á‡∏≤‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£';
                    achievement = '‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡πà‡∏ô: ‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á';
                } else if (title.includes('1008Bit Company')) {
                    details = '‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ React ‡πÅ‡∏•‡∏∞ Angular ‡∏ù‡∏±‡πà‡∏á Frontend ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á Django ‡πÅ‡∏•‡∏∞ Spring Boot ‡∏ù‡∏±‡πà‡∏á Backend ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á API ‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ ‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô';
                    achievement = '‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡πà‡∏ô: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö API ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á deploy ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö';
                }
            } else {
                if (title.includes('4Xtreme')) {
                    details = 'Supported frontend development tasks during internship and applied Entity Framework within assigned modules, ensuring deliverables aligned with team coding standards and project timelines.';
                    achievement = 'Key Achievement: Consistently delivered assigned frontend features on schedule while maintaining team quality standards.';
                } else if (title.includes('1008Bit Company')) {
                    details = 'Responsible for developing and maintaining business web applications using React and Angular for frontend, together with Django and Spring Boot for backend services; also designed reusable API structures and supported release workflows to improve delivery efficiency.';
                    achievement = 'Key Achievement: Improved delivery efficiency by introducing reusable API patterns and a more consistent release workflow.';
                }
            }

            return { period, title, details, achievement };
        });

        const labels = {
            en: {
                title: 'Curriculum Vitae',
                profile: 'Profile',
                professionalSummary: 'Professional Summary',
                coreCompetencies: 'Core Competencies',
                experience: 'Professional Experience',
                additional: 'Additional Highlights'
            },
            th: {
                title: '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (Curriculum Vitae)',
                profile: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß',
                professionalSummary: '‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û',
                coreCompetencies: '‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏´‡∏•‡∏±‡∏Å',
                experience: '‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
                additional: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°'
            }
        };

        const formalProfileByLang = {
            en: about,
            th: 'Nithisaran ‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤ Full Stack ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏ö‡∏ö API ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå ‡πÑ‡∏õ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÇ‡∏î‡∏¢‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÇ‡∏Ñ‡πâ‡∏î ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô.'
        };

        const formalSummaryByLang = {
            en: summary,
            th: '‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ß‡πá‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ù‡∏±‡πà‡∏á Frontend ‡πÅ‡∏•‡∏∞ Backend ‡∏î‡πâ‡∏ß‡∏¢ React, Angular, Django ‡πÅ‡∏•‡∏∞ Spring Boot ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Google Firebase ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡∏∞‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á.'
        };

        const formalHighlights = {
            en: [
                'Designs and delivers end-to-end web solutions from UI implementation to backend services.',
                'Builds maintainable APIs and supports deployment workflows for reliable production releases.',
                'Collaborates effectively in cross-functional teams and adapts quickly to project requirements.'
            ],
            th: [
                '‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå',
                '‡∏û‡∏±‡∏í‡∏ô‡∏≤ API ‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ deploy ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á',
                '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡∏Ç‡πâ‡∏≤‡∏°‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß'
            ]
        };

        const profileImageSrc = document.querySelector('img[alt="Profile picture"]')?.getAttribute('src') || '/images/profile-avatar.png';

        return {
            name,
            role,
            summary: formalSummaryByLang[lang],
            about: formalProfileByLang[lang],
            skillItems,
            experienceItems,
            labels: labels[lang],
            formalHighlights: formalHighlights[lang],
            profileImageSrc
        };
    };

    const resolveImageAsDataUrl = async (src) => {
        if (!src) return '';

        try {
            const response = await fetch(src);
            const blob = await response.blob();

            return await new Promise((resolve) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve(typeof reader.result === 'string' ? reader.result : '');
                reader.readAsDataURL(blob);
            });
        } catch {
            return src;
        }
    };

    const createCvElement = async (lang) => {
        const data = buildCvData(lang);
        const imageDataUrl = await resolveImageAsDataUrl(data.profileImageSrc);
        const container = document.createElement('div');

        container.style.position = 'fixed';
        container.style.left = '-99999px';
        container.style.top = '0';
        container.style.width = '794px';
        container.style.padding = '26px';
        container.style.background = '#ffffff';
        container.style.color = '#111827';
        container.style.fontFamily = "Arial, 'Noto Sans Thai', sans-serif";
        container.style.fontSize = '13.5px';
        container.style.lineHeight = '1.6';
        container.style.zIndex = '-1';

        container.innerHTML = `
            <div style="display:flex;align-items:stretch;overflow:hidden;">
                <aside style="width:34%;background:#f8fafc;padding:18px 16px;">
                    <div style="display:flex;justify-content:center;margin-bottom:12px;">
                        <img src="${escapeHtml(imageDataUrl)}" alt="Profile" style="width:108px;height:108px;border-radius:12px;object-fit:cover;" />
                    </div>
                    <h1 style="margin:0 0 3px 0;font-size:24px;line-height:1.2;color:#0f172a;text-align:center;">${escapeHtml(data.name)}</h1>
                    <p style="margin:0 0 2px 0;color:#1e40af;font-size:15px;font-weight:700;text-align:center;">${escapeHtml(data.role)}</p>
                    <p style="margin:0 0 14px 0;color:#475569;font-size:12px;text-align:center;">${escapeHtml(data.labels.title)}</p>

                    <h2 style="margin:0 0 8px 0;font-size:14px;letter-spacing:0.04em;text-transform:uppercase;color:#0f172a;padding-bottom:4px;">${escapeHtml(data.labels.coreCompetencies)}</h2>
                    <ul style="margin:0 0 14px 18px;padding:0;">
                        ${data.skillItems.map((item) => `<li style="margin:0 0 5px 0;">${escapeHtml(item)}</li>`).join('')}
                    </ul>

                    <h2 style="margin:0 0 8px 0;font-size:14px;letter-spacing:0.04em;text-transform:uppercase;color:#0f172a;padding-bottom:4px;">${escapeHtml(data.labels.additional)}</h2>
                    <ul style="margin:0 0 0 18px;padding:0;">
                        ${data.formalHighlights.map((item) => `<li style="margin:0 0 6px 0;">${escapeHtml(item)}</li>`).join('')}
                    </ul>
                </aside>

                <main style="width:66%;padding:18px 18px 16px 18px;">
                    <h2 style="margin:0 0 8px 0;font-size:15px;letter-spacing:0.04em;text-transform:uppercase;color:#0f172a;padding-bottom:4px;">${escapeHtml(data.labels.profile)}</h2>
                    <p style="margin:0 0 14px 0;">${escapeHtml(data.about)}</p>

                    <h2 style="margin:0 0 8px 0;font-size:15px;letter-spacing:0.04em;text-transform:uppercase;color:#0f172a;padding-bottom:4px;">${escapeHtml(data.labels.professionalSummary)}</h2>
                    <p style="margin:0 0 14px 0;">${escapeHtml(data.summary)}</p>

                    <h2 style="margin:0 0 8px 0;font-size:15px;letter-spacing:0.04em;text-transform:uppercase;color:#0f172a;padding-bottom:4px;">${escapeHtml(data.labels.experience)}</h2>
                    <div style="display:grid;gap:10px;">
                        ${data.experienceItems
                            .map(
                                (item) =>
                                    `<section style="padding:9px 10px;"><p style="margin:0 0 4px 0;color:#475569;font-size:12px;">${escapeHtml(item.period)}</p><p style="margin:0 0 4px 0;font-weight:700;color:#0f172a;">${escapeHtml(item.title)}</p><p style="margin:0 0 4px 0;color:#1f2937;">${escapeHtml(item.details)}</p><p style="margin:0;color:#1e40af;font-size:12.5px;font-weight:600;">${escapeHtml(item.achievement)}</p></section>`
                            )
                            .join('')}
                    </div>
                </main>
            </div>
        `;

        document.body.appendChild(container);
        return container;
    };

    const exportCvPdf = async (lang) => {
        const container = await createCvElement(lang);

        const canvas = await html2canvas(container, {
            scale: 2,
            useCORS: true,
            backgroundColor: '#ffffff',
            allowTaint: true
        });

        document.body.removeChild(container);

        const documentPdf = new jsPDF({ unit: 'pt', format: 'a4' });
        const pageWidth = documentPdf.internal.pageSize.getWidth();
        const pageHeight = documentPdf.internal.pageSize.getHeight();
        const margin = 24;
        const imageWidth = pageWidth - margin * 2;
        const imageHeight = (canvas.height * imageWidth) / canvas.width;
        const imageData = canvas.toDataURL('image/png');

        let remainingHeight = imageHeight;
        let yPosition = margin;

        documentPdf.addImage(imageData, 'PNG', margin, yPosition, imageWidth, imageHeight);
        remainingHeight -= pageHeight - margin * 2;

        while (remainingHeight > 0) {
            documentPdf.addPage();
            yPosition = margin - (imageHeight - remainingHeight);
            documentPdf.addImage(imageData, 'PNG', margin, yPosition, imageWidth, imageHeight);
            remainingHeight -= pageHeight - margin * 2;
        }

        const filename = lang === 'th' ? 'Nithisaran-CV-TH.pdf' : 'Nithisaran-CV-EN.pdf';
        documentPdf.save(filename);
    };

    const downloadCvEnButton = document.getElementById('downloadCvEnBtn');
    const downloadCvThButton = document.getElementById('downloadCvThBtn');

    downloadCvEnButton?.addEventListener('click', async () => {
        await exportCvPdf('en');
    });

    downloadCvThButton?.addEventListener('click', async () => {
        await exportCvPdf('th');
    });
</script>
